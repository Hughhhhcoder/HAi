# 局域网访问说明

## 🌐 访问地址

### 在主机（Mac）上访问
- 前端：http://localhost:5174
- 后端 API：http://localhost:8000
- API 文档：http://localhost:8000/docs

### 在局域网内其他设备访问

**你的局域网 IP：`192.168.110.17`**

- 前端：**http://192.168.110.17:5174**
- 后端 API：http://192.168.110.17:8000
- API 文档：http://192.168.110.17:8000/docs

## 📱 使用步骤

### 1. 确保设备在同一局域网
- 手机/平板连接同一个 Wi-Fi
- 其他电脑连接同一个网络

### 2. 在浏览器打开
```
http://192.168.110.17:5174
```

### 3. 登录测试账号
- 用户名：`admin`
- 密码：`admin123`

## 🔧 配置说明

已完成的配置：
- ✅ 后端 CORS 允许局域网访问
- ✅ Docker 端口映射到所有网络接口（0.0.0.0）
- ✅ 前端通过 Nginx 反向代理后端 API

## 🔥 防火墙设置

如果无法访问，可能需要检查防火墙：

### macOS 防火墙
1. 系统设置 → 网络 → 防火墙
2. 确保防火墙关闭，或者
3. 点击"防火墙选项"→ 添加 Docker 为允许项

### 临时关闭防火墙测试
```bash
# 查看防火墙状态
sudo /usr/libexec/ApplicationFirewall/socketfilterfw --getglobalstate

# 临时关闭（测试用）
sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setglobalstate off

# 测试完后记得重新开启
sudo /usr/libexec/ApplicationFirewall/socketfilterfw --setglobalstate on
```

## 📊 端口说明

| 服务 | 端口 | 说明 |
|------|------|------|
| 前端 | 5174 | Vue 3 应用（Nginx） |
| 后端 | 8000 | FastAPI 服务 |
| MySQL | 3307 | 数据库（映射到主机） |
| Redis | 6379 | 缓存 |

## 🚀 重启服务

如果修改了配置需要重启：

```bash
cd /Users/Hughhhh/projects/Hai
docker compose down
docker compose up -d --build
```

## 🔍 故障排查

### 1. 无法访问前端
```bash
# 检查容器状态
docker compose ps

# 查看前端日志
docker logs hai-frontend

# 测试端口是否开放
curl http://192.168.110.17:5174
```

### 2. 前端可以访问但 API 报错
```bash
# 查看后端日志
docker logs hai-backend

# 测试 API
curl http://192.168.110.17:8000/ping
```

### 3. 获取最新的局域网 IP
```bash
ifconfig | grep "inet " | grep -v 127.0.0.1
```

如果 IP 地址变了，需要更新 `backend/app/main.py` 中的 CORS 配置。

## 💡 提示

1. **动态 IP**：如果你的局域网 IP 会变化（路由器 DHCP），建议在路由器设置中为你的 Mac 分配固定 IP
2. **性能**：局域网访问速度取决于 Wi-Fi 信号强度
3. **安全**：这是开发配置，生产环境需要添加认证和 HTTPS

## 🌟 测试功能

在局域网设备上可以测试：
- ✅ 用户登录/注册
- ✅ 10 个专业 AI 角色对话
- ✅ 图片上传（最大 50MB）
- ✅ 心理测评（PHQ9、GAD7）
- ✅ 每日打卡
- ✅ 文献检索
- ✅ 积分系统

享受你的心理健康 AI 平台吧！🎉

